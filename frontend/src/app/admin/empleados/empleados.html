<div class="empleados-container">
  <div class="empleados-header">
    <div class="header-title">
      <h1>Listado de Empleados</h1>
    </div>
    
    <div class="filters">
      <app-input-select
        label="Sucursal"
        [options]="sucursalStore.sucursales()"
        [control]="sucursalControl"
        placeHolder="Todas las sucursales"
      />
      
      <app-input-select
        label="Estado"
        [options]="estados"
        [control]="estadoControl"
        placeHolder="Todos los estados"
      />
      <app-button class="clear-filters" label="Limpiar filtros" (action)="clearFilters()" [disabled]="this.disabled()"></app-button>
      <app-button label="+ Crear Empleado" (action)="navigateToCreate()" class="btn-create"></app-button>
    </div>
  </div>
  
  <div class="table-container">
    <table class="empleados-table">
      <thead>
        <tr>
          <th>DNI</th>
          <th>Nombre</th>
          <th>Apellido</th>
          <th>Email</th>
          <th>Sucursal</th>
          <th>Estado</th>
          <th>Fecha de Baja</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        @if(empleadosFiltrados()){
            @for(empleado of empleadosFiltrados(); track empleado.dni) {
            <tr [class.de-baja]="empleado.estado === 'DE_BAJA'">
                <td>{{ empleado.dni }}</td>
                <td>{{ empleado.nombre }}</td>
                <td>{{ empleado.apellido }}</td>
                <td>{{ empleado.email }}</td>
                <td>{{ empleado.trabajaEnSucursal }}</td>
                <td>
                <span class="estado-badge" [class.activo]="empleado.estado === 'ACTIVO'" [class.baja]="empleado.estado === 'DE_BAJA'">
                    {{ empleado.estado}}
                </span>
                </td>
                <td>{{ empleado.fechaBaja ? (empleado.fechaBaja | date: 'dd/MM/yyyy') : '-' }}</td>
                <td>
                  @if (empleado.estado === 'ACTIVO') {
                    <app-button 
                      label="Dar de Baja" 
                      (action)="darDeBaja(empleado.email)" 
                      class="btn-baja"
                    ></app-button>
                  }
                </td>
            </tr>
        }
        @empty {
          <tr>
            <td colspan="8" class="no-data">No hay empleados para mostrar</td>
          </tr>
        } 
    }
      </tbody>
    </table>
  </div>
  
  @if (empleadoStore.isLoading()) {
    <div class="loading">Cargando empleados...</div>
  }
  
  @if (empleadoStore.error()) {
    <div class="error">{{ empleadoStore.error() }}</div>
  }
</div>
